

*   ####    Modify root user's password
    *   ```$ sudo -i```
    *   ```$ passwd```
    *   Double enter password

*   ####    Create your own user & add to root group
    *   ```$ sudo -i```
    *   ```$ sudo adduser username``` 
    *   ```$ sudo usermod -aG sudo username```
    *   ```$ id username```

*   ####    Log on your server with SHH and own user
    *   ```$ ssh-copy-id username@your_server_ip```
    *   ```$ ssh username@your_server_ip```

*   ####    Edit SSHD/SSH config file
    *   ```$ sudo nano /etc/ssh/sshd_config```
    *   Uncomment: **PasswordAuthentication yes**, change value to **no**
    *   Set **PermitRootLogin** to **no**
    *   Add: **AllowUsers *username***
    *   Add: **TCPKeepAlive yes**
    *   Save and: ```$ sudo systemctl restart ssh```
    *   On local computer: ```$ sudo nano /etc/ssh/ssh_config``` and add:   **ServerAliveInterval 120**

*   ####    Setting up basic firewall
    *   ```$ sudo ufw app list```
    *   ```$ sudo ufw allow OpenSSH```
    *   ```$ sudo ufw allow 22``` for SSH/SFTP
    *   ```$ sudo ufw allow proto tcp from any to any port 80,443``` for HTTP/HTTPS
    *   ```$ sudo ufw enable```
    *   ```$ sudo ufw status```

*   ####    APACHE
    *   ```$ sudo apt update && sudo apt upgrade```
    *   ```$ sudo apt install apache2```
    *   ```$ sudo ufw allow 'Apache'```

*   ####    Virtual hosts
    >   Set up one virtual for each of your domain name
    *   #####   Config www folder
        *   ```$ sudo mkdir -p /var/www/domainname.com/public_html```
        *   ```$ sudo chown -R $USER:$USER /var/www/domainname.com/public_html```
        *   ```$ sudo chmod -R 755 /var/www/```
        *   ```$ sudo nano /var/www/domainname.com/public_html/index.html``` test file
        *   Add basic HTML page's content 
    *   #####   Set up .conf files
        *   ```$ sudo cp /etc/apache2/sites-available/000-default.conf /etc/apache2/sites-available/domainname.com.conf```
        *   ```$ sudo nano /etc/apache2/sites-available/domainname.com.conf```
        *   Overwrite with followings values :   
        ```<VirtualHost *:80>```    
        ```ServerAdmin admin@test.com```     
        ```ServerName test.com```   
        ```ServerAlias www.test.com```  
        ```DocumentRoot /var/www/test.com/public_html```    
        ```ErrorLog ${APACHE_LOG_DIR}/error.log```  
        ```CustomLog ${APACHE_LOG_DIR}/access.log combined```   
        ```</VirtualHost>```   
    *   #####   Test config and activate virtual host
        *   ```$ sudo apache2ctl configtest``` Result: **Syntax OK**
        *   ```$ sudo a2ensite domainname.com.conf```
        *   ```$ sudo service apache2 restart```

*   ####    CERTBOT - SSL CERTIFICATION
    >   Set up SSL certificates
    *   #####   Installation 
        *   ```$ sudo apt update && sudo apt upgrade```
        *   ```$ sudo apt install certbot python3-certbot-apache```

    *   #####   Allow HTTPS trough the firewall
        *   ```$ sudo ufw status```
        *   ```$ sudo ufw allow 'Apache Full'```
        *   ```$ sudo ufw delete allow 'Apache'```
        *   Check if access is *Apache Full* with again:    
            ```$ sudo ufw status```

    *   #####   Obtaining an SSL Certificate
        *   ```$ sudo certbot --apache```
        *   Enter a valid email adress, it'll be used for renewal !
        *   Agree the terms of service
        *   Share or not your email (not recommended)
        *   Each domain for wich you can activate a certificate, choose one or many, if many separate choice's number by a space
        *   Validate and wait for the certification to be done
        *   Test your website with HTTPS, and the magic happens :magic_wand:
        *   You can use following to check renewal (if no error it's fine): 
            ```$ sudo systemctl status certbot.timer``` 
            ```$ sudo certbot renew --dry-run```

*   ####    .HTACCESS
    >   Repeat for each of your virtual host
    *   #####   Set up Apache
        *   ```$ sudo nano /etc/apache2/sites-available/domainname.com.conf```
        *   Add following lines after the **</virtualHost>** line:   
            ```<Directory /var/www/domainname.com/public_html> ```
            ```    Options Indexes FollowSymLinks  ```
            ```    AllowOverride All   ```
            ```    Require all granted ```
            ```</Directory>   ```
        *   ```$ sudo service apache2 restart```
    
    *   #####   Create & configure .HTACCESS file
        *   ```$ cd var/www/domainname.com/public_html```
        *   ```$ touch .htacess```
        *   Add **Options -Indexes** and save
        *   This file can be edited for redirection, 404 page, filters, ...

*   ####    MYSQL
    >   MySQL is mandatory if you aim to use WordPress cause it's been develop around its architecture

    *   #####   Installation
        *   ```$ sudo apt update && sudo apt upgrade```
        *   ```$ sudo apt install mysql-server```

    *   #####   Configuration
        *   ```$ sudo mysql_secure_installation```
        *   Choose a level of security for passwords, from 0 to 2
        *   Enter and confirm your password 
        *   Answer other security questions (YES = more secure)

*   ####    PHP
    *   ```$ sudo apt install php libapache2-mod-php php-mysql```
    *   ```$ php -v```

*   ####    WORDPRESS
    >   Most used CMS 
    *   #####   Create database and user in MySQL
        *   ```$ mysql -u root -p```
        *   ```mysql> CREATE DATABASE wordpress DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci;```
        *   ```mysql> CREATE USER 'wordpressuser'@'%' IDENTIFIED WITH mysql_native_password BY 'password';```
        *   ```mysql> GRANT ALL ON wordpress.* TO 'wordpressuser'@'%';```
        *   ```mysql> FLUSH PRIVILEGES;```
        *   ```mysql> EXIT;```

    *   #####   Additionnal PHP extensions
        *   ```$ sudo apt update && sudo apt upgrade```
        *   ```$ sudo apt install php-curl php-gd php-mbstring php-xml php-xmlrpc php-soap php-intl php-zip```
        *   ```sudo systemctl restart apache2```

    *   #####   Enabling .HTACCESS ovverides
        *   ```$ sudo nano /etc/apache2/sites-available/wordpress.conf```
        *   Add followings:
            ```<Directory /var/www/wordpress/>```      
            ```     AllowOverride All```    
            ```</Directory>```

    *   #####    Enabling rewrite module
        *   ```$ sudo a2enmod rewrite```
        *   ```$ sudo apache2ctl configtest```
        *   ```$ sudo systemctl restart apache2```

    *   #####    Downloading / Unzipping WordPress
        *   ```$ cd /tmp```
        *   ```$ curl -O https://wordpress.org/latest.tar.gz```
        *   ```$ tar xzvf latest.tar.gz```
        *   ```$ touch /tmp/wordpress/.htaccess```
        *   ```$ cp /tmp/wordpress/wp-config-sample.php /tmp/wordpress/wp-config.php```
        *   ```$ mkdir /tmp/wordpress/wp-content/upgrade```
        *   ```$ sudo cp -a /tmp/wordpress/. /var/www/project_directory```
    
    *   #####   Configuring WordPress directory
        *   ```$ sudo chown -R www-data:www-data /var/www/project_directory``` 
        *   ```$ sudo find /var/www/wordpress/ -type d -exec chmod 750 {} \;```
        *   ```$ sudo find /var/www/wordpress/ -type f -exec chmod 640 {} \;```

    *   #####   Set up WordPress configuration file
        *   ```$ curl -s https://api.wordpress.org/secret-key/1.1/salt/```
        *   Copy the 8 security keys
        *   ```$ sudo nano /var/www/wordpress/wp-config.php```
        *   Replace default keys by pasting in the good section
        *   Replace database default values by your database informations
        *   Below database informations, add: **define('FS_METHOD', 'direct');**
    
    *   ####    Complete installation online
        *   Go to: **https://server_domain** or **https://ip**
        *   Select language
        *   Choose a site name, username, strong password and email
        *   Validate and on the next page, log in and enjoy ;)



    



